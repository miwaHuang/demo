<body class="content_page modal-open" style="max-height: 860px">
  <input
    type="hidden"
    name="MemberToken"
    id="MemberToken"
    value="a8qJeBLxqATcNZlCfiIkUayRcM0AUSWW5GjJZ%2fMCETfUKijAizM5FBAgd3686JEukCmx%2byi3deG4B%2bYdFrDSpke1ubJdWmoTLYOzzd708MQZehAZP79yTUlilCpoeMjZdr5OJqEHaq7lCUuL%2f5imFfCCvkWN4EqM4s7OcBggpPSsTgw5NG7UtCbQeM4%2fe%2fBSewUaJjSq7FcvytG%2b1xAqmXpE0Q%2fBtBcUcxf%2fF2Otx%2bEKqb1aUKfkMQNb0R6OTiz4KAbgGGH0rSDuhs%2bNLpjFx%2f%2f4aF7pFOL8B5uv5SWAr14tbnh%2blg9dq%2fEl9j2PHU17jtvrMcE8CnN%2bnILJDuDJSlAAUgHhCOcbGlr6n%2foJrA35alfqenWjw8GNDkSEMSO3FJq6MvSj%2byjqDIXLpHGxfpaagAnZKTsxU%2fQ9RrSSsKlIYYbhgrwYKjkUMxdtOnGvog3rLzcI6T7k4379gs4jAw%3d%3d"
    autocomplete="off"
  />

  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item">救護紀錄管理</li>
      <li class="breadcrumb-item">報案紀錄管理</li>
      <li class="breadcrumb-item active" aria-current="page">報案紀錄維護</li>
    </ol>
  </nav>
  <div class="subpage-box">
    <div
      class="tab-struct form-abs-left tab-shrink"
      data-toggle="tab-container"
    >
      <ul class="nav nav-tabs">
        <li class="active">
          <a
            aria-expanded="true"
            data-toggle="tab"
            role="tab"
            id="Form_Search"
            href="#FormSearch"
            ><span class="text">查詢列表</span></a
          >
        </li>
      </ul>
      <div class="tab-content">
        <form id="FormSearch" class="tab-pane active">
          <input
            name="__RequestVerificationToken"
            type="hidden"
            value="HKeg8MoWzBH7BuKbf-wZp50xAOZ06gY6VFpZoxm9dMmrD_tDhk_xZZDlYa0h-hyeZqmx0fmRtOPLp0RCZQxSD79JF9wV-zlpcJIxaZSbM6pYU86NRO78-93PrUQ0KenI0"
            autocomplete="off"
          />
          <div class="row search-content">
            <div class="col-md-12">
              <div class="form-horizontal">
                <div class="form-group">
                  <label class="col-sm-5 control-label">指派案號</label>
                  <div class="col-sm-7">
                    <input
                      class="form-control"
                      id="Q_FIREDEPT_CASENO"
                      maxlength="17"
                      name="Q_FIREDEPT_CASENO"
                      placeholder="救災救護指揮中心指派案號"
                      type="text"
                      value=""
                      autocomplete="off"
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-5 control-label">案號</label>
                  <div class="col-sm-7">
                    <input
                      class="form-control"
                      id="Q_CASE_NO"
                      name="Q_CASE_NO"
                      placeholder="緊急醫療管理系統案號"
                      type="text"
                      value=""
                      autocomplete="off"
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-5 control-label">受理時間(起)</label>
                  <div class="col-sm-7">
                    <div class="input-group padding-none">
                      <div class="input-group-addon">
                        <i class="zmdi zmdi-calendar-note"></i>
                      </div>
                      <input
                        class="form-control hasDatepicker"
                        id="Q_CASE_DATE_S"
                        maxlength="10"
                        name="Q_CASE_DATE_S"
                        onblur="checknewQtime('Q_CASE_DATE_S', 'date')"
                        onkeyup="newQtime('Q_CASE_DATE_S', 'date')"
                        type="text"
                        value="2025-12-13"
                        autocomplete="off"
                      />
                    </div>
                    <div class="input-group padding-none">
                      <div class="input-group-addon">
                        <i class="zmdi zmdi-time"></i>
                      </div>
                      <input
                        class="form-control"
                        id="Q_CASE_TIME_S"
                        maxlength="8"
                        name="Q_CASE_TIME_S"
                        onblur="checknewQtime('Q_CASE_TIME_S', 'time')"
                        onkeyup="newQtime('Q_CASE_TIME_S', 'time')"
                        type="text"
                        value="00:00:00"
                        autocomplete="off"
                      />
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label
                    class="col-sm-5 control-label"
                    title="自動帶入受理時間(起)"
                    >受理時間(迄)</label
                  >
                  <div class="col-sm-7">
                    <div class="input-group padding-none">
                      <div class="input-group-addon">
                        <i class="zmdi zmdi-calendar-note"></i>
                      </div>
                      <input
                        class="form-control hasDatepicker"
                        id="Q_CASE_DATE_E"
                        maxlength="10"
                        name="Q_CASE_DATE_E"
                        onblur="checknewQtime('Q_CASE_DATE_E', 'date')"
                        onkeyup="newQtime('Q_CASE_DATE_E', 'date')"
                        type="text"
                        value="2026-01-13"
                        autocomplete="off"
                      />
                    </div>
                    <div class="input-group padding-none">
                      <div class="input-group-addon">
                        <i class="zmdi zmdi-time"></i>
                      </div>
                      <input
                        class="form-control"
                        id="Q_CASE_TIME_E"
                        maxlength="8"
                        name="Q_CASE_TIME_E"
                        onblur="checknewQtime('Q_CASE_TIME_E', 'time')"
                        onkeyup="newQtime('Q_CASE_TIME_E', 'time')"
                        type="text"
                        value="23:59:59"
                        autocomplete="off"
                      />
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-5 control-label">案由</label>
                  <div class="col-sm-7">
                    <select class="form-control" id="Q_REASON" name="Q_REASON">
                      <option value="">請選擇</option>
                      <option value="11">車禍</option>
                      <option value="12">急病</option>
                      <option value="13">路倒</option>
                      <option value="14">孕婦待產</option>
                      <option value="15">自殺</option>
                      <option value="16">疑似中毒</option>
                      <option value="18">觸電</option>
                      <option value="19">救溺</option>
                      <option value="1A">災害受傷</option>
                      <option value="1Z">其它(救護)</option>
                      <option value="20">疾病</option>
                      <option value="31">車禍處理</option>
                      <option value="33">打殺</option>
                      <option value="3Z">其它(受理轉報)</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label
                    class="col-sm-5 control-label"
                    title="分隊可額外查詢消防局的接報人"
                    >接報人</label
                  >
                  <div class="col-sm-7">
                    <select
                      class="form-control select2-hidden-accessible"
                      id="Q_CASE_HOLDER"
                      name="Q_CASE_HOLDER"
                      data-select2-id="Q_CASE_HOLDER"
                      tabindex="-1"
                      aria-hidden="true"
                    >
                      <option value="" data-select2-id="2">
                        請選擇
                      </option></select
                    ><span
                      class="select2 select2-container select2-container--bootstrap"
                      dir="ltr"
                      data-select2-id="1"
                      style="width: 205.078px"
                      ><span class="selection"
                        ><span
                          class="select2-selection select2-selection--single"
                          role="combobox"
                          aria-haspopup="true"
                          aria-expanded="false"
                          tabindex="0"
                          aria-labelledby="select2-Q_CASE_HOLDER-container"
                          ><span
                            class="select2-selection__rendered"
                            id="select2-Q_CASE_HOLDER-container"
                            role="textbox"
                            aria-readonly="true"
                            ><span class="select2-selection__placeholder"
                              >接報人</span
                            ></span
                          ><span
                            class="select2-selection__arrow"
                            role="presentation"
                            ><b role="presentation"></b></span></span></span
                      ><span class="dropdown-wrapper" aria-hidden="true"></span
                    ></span>
                  </div>
                </div>

                <div class="form-group">
                  <label class="col-sm-5 control-label">詳細發生地點</label>
                  <div class="col-sm-7">
                    <input
                      class="form-control"
                      id="Q_ACCIDENT_ADDR"
                      name="Q_ACCIDENT_ADDR"
                      placeholder="詳細發生地點"
                      type="text"
                      value=""
                      autocomplete="off"
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-5 control-label">備註</label>
                  <div class="col-sm-7">
                    <input
                      class="form-control"
                      id="Q_CASE_REMARK"
                      name="Q_CASE_REMARK"
                      placeholder="備註"
                      type="text"
                      value=""
                      autocomplete="off"
                    />
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-5 control-label">出勤單位縣市</label>
                  <div class="col-sm-7">
                    <select
                      class="form-control"
                      id="Q_AID_DEPT_COUNTY"
                      name="Q_AID_DEPT_COUNTY"
                    >
                      <option value="">請選擇</option>
                      <option value="01">台北市</option>
                      <option value="03">台中市</option>
                      <option value="05">台南市</option>
                      <option value="07">高雄市</option>
                      <option value="11">基隆市</option>
                      <option value="12">新竹市</option>
                      <option value="22">嘉義市</option>
                      <option value="31">新北市</option>
                      <option value="32">桃園市</option>
                      <option value="33">新竹縣</option>
                      <option value="34">宜蘭縣</option>
                      <option value="35">苗栗縣</option>
                      <option value="37">彰化縣</option>
                      <option value="38">南投縣</option>
                      <option value="39">雲林縣</option>
                      <option value="40">嘉義縣</option>
                      <option value="43">屏東縣</option>
                      <option value="44">澎湖縣</option>
                      <option value="45">花蓮縣</option>
                      <option value="46">台東縣</option>
                      <option value="90">金門縣</option>
                      <option value="91">連江縣</option>
                      <option value="A1">基隆港</option>
                      <option value="B1">臺中港</option>
                      <option value="C1">高雄港</option>
                      <option value="D1">花蓮港</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-sm-5 control-label">出勤單位</label>
                  <div class="col-sm-7">
                    <select
                      class="form-control"
                      id="Q_AID_DEPT_NO"
                      name="Q_AID_DEPT_NO"
                    ></select>
                  </div>
                </div>
                <div class="form-group">
                  <label
                    class="col-sm-5 control-label"
                    title="檢查出勤通知時間小於受理時間的案件"
                    >檢查反應時間</label
                  >
                  <div class="col-sm-7">
                    <select
                      class="form-control"
                      id="Q_TIME_ERROR"
                      name="Q_TIME_ERROR"
                    >
                      <option value="">請選擇</option>
                      <option value="Y">異常</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label
                    class="col-sm-5 control-label"
                    title="檢查無救護紀錄表的案件"
                    >檢查有無救護紀錄表</label
                  >
                  <div class="col-sm-7">
                    <select
                      class="form-control"
                      id="Q_AID_ERROR"
                      name="Q_AID_ERROR"
                    >
                      <option value="">請選擇</option>
                      <option value="1">有</option>
                      <option value="2">無</option>
                    </select>
                  </div>
                </div>
                <div class="form-group">
                  <label
                    class="col-sm-5 control-label"
                    title="檢查同時送醫與未送醫或兩個以上單位出勤案件"
                    >重複計算案件</label
                  >
                  <div class="col-sm-7">
                    <select
                      class="form-control"
                      id="Q_DOUBLE_ERROR"
                      name="Q_DOUBLE_ERROR"
                    >
                      <option value="">請選擇</option>
                      <option value="Y">是</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row search-btns">
            <div class="col-md-12">
              <button
                type="button"
                class="btn btn-success"
                onclick="EMS_SearchDataGrid('SearchDataGridList')"
              >
                查詢
              </button>
              <button
                type="button"
                class="btn btn-gray"
                onclick="ClearForm('FormSearch')"
              >
                清除
              </button>
              <button
                type="button"
                class="btn btn-success"
                onclick="OutputExcel()"
              >
                資料匯出
              </button>
            </div>
          </div>
        </form>
      </div>
      <div class="form-abs-arrow">
        <i class="fa fa-angle-double-left"></i
        ><i class="fa fa-angle-double-right"></i>
        <span>查詢列表</span>
      </div>
    </div>
  </div>
  <div
    class="datagrid-box col-sm-12 box-position-relative padding-left-35 datagrid-single-select panel-noscroll"
    style="height: 65%"
  >
    <div class="panel datagrid" style="width: 1645px">
      <div
        class="datagrid-wrap panel-body panel-body-noheader"
        title=""
        id=""
        style="width: 1643px; height: 557px"
      >
        <div class="datagrid-view" style="width: 1643px; height: 510.766px">
          <div class="datagrid-view1" style="width: 59px">
            <div class="datagrid-header" style="width: 59px; height: 55px">
              <div class="datagrid-header-inner" style="display: block">
                <table
                  class="datagrid-htable"
                  border="0"
                  cellspacing="0"
                  cellpadding="0"
                  style="height: 55px"
                >
                  <tbody>
                    <tr class="datagrid-header-row">
                      <td rowspan="1">
                        <div class="datagrid-header-rownumber"></div>
                      </td>
                      <td field="checkbox">
                        <div class="datagrid-header-check">
                          <input type="checkbox" autocomplete="off" />
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div
              class="datagrid-body"
              style="width: 59px; margin-top: 0px; height: 455.781px"
            >
              <div class="datagrid-body-inner">
                <table
                  class="datagrid-btable"
                  cellspacing="0"
                  cellpadding="0"
                  border="0"
                  style="table-layout: auto"
                >
                  <tbody></tbody>
                </table>
              </div>
            </div>
            <div class="datagrid-footer" style="width: 59px">
              <div class="datagrid-footer-inner" style="display: none"></div>
            </div>
          </div>
          <div class="datagrid-view2" style="width: 1584px">
            <div class="datagrid-header" style="width: 1584px; height: 55px">
              <div class="datagrid-header-inner" style="display: block">
                <table
                  class="datagrid-htable"
                  border="0"
                  cellspacing="0"
                  cellpadding="0"
                  style="height: 55px"
                >
                  <tbody>
                    <tr class="datagrid-header-row">
                      <td field="FIREDEPT_CASENO">
                        <div
                          class="datagrid-cell datagrid-cell-c1-FIREDEPT_CASENO"
                          style="text-align: center"
                        >
                          <span>指派案號</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="EM_CASE_NO">
                        <div
                          class="datagrid-cell datagrid-cell-c1-EM_CASE_NO"
                          style="text-align: center"
                        >
                          <span>案號</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="CASE_DATE">
                        <div
                          class="datagrid-cell datagrid-cell-c1-CASE_DATE"
                          style="text-align: center"
                        >
                          <span>報案日期</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="CASE_TIME">
                        <div
                          class="datagrid-cell datagrid-cell-c1-CASE_TIME"
                          style="text-align: center"
                        >
                          <span>受理時間</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="MIN_AMBUTIME_1">
                        <div
                          class="datagrid-cell datagrid-cell-c1-MIN_AMBUTIME_1"
                          style="text-align: center"
                        >
                          <span>出勤通知時間</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="CASE_REASON">
                        <div
                          class="datagrid-cell datagrid-cell-c1-CASE_REASON"
                          style="text-align: center"
                        >
                          <span>案由</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="ACCIDENT_AREA">
                        <div
                          class="datagrid-cell datagrid-cell-c1-ACCIDENT_AREA"
                          style="text-align: center"
                        >
                          <span>發生行政區</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="ACCIDENT_ADDR">
                        <div
                          class="datagrid-cell datagrid-cell-c1-ACCIDENT_ADDR"
                          style="text-align: center"
                        >
                          <span>詳細發生地點</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="CASE_NO_ENCODE" style="display: none">
                        <div
                          class="datagrid-cell datagrid-cell-c1-CASE_NO_ENCODE"
                          style=""
                        >
                          <span>undefined</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                      <td field="CASE_LOCK" style="display: none">
                        <div
                          class="datagrid-cell datagrid-cell-c1-CASE_LOCK"
                          style=""
                        >
                          <span>undefined</span
                          ><span class="datagrid-sort-icon">&nbsp;</span>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div
              class="datagrid-body"
              style="width: 1584px; margin-top: 0px; height: 455.781px"
            >
              <table
                class="datagrid-btable"
                cellspacing="0"
                cellpadding="0"
                border="0"
                style="table-layout: auto"
              >
                <tbody></tbody>
              </table>
            </div>
            <div class="datagrid-footer" style="width: 1584px">
              <div class="datagrid-footer-inner" style="display: none"></div>
            </div>
          </div>
          <table
            class="EMSDataGrid"
            id="SearchDataGridList"
            style="height: auto; display: none"
            data-options="rownumbers:true,singleSelect:true,fit:true"
          ></table>
          <style type="text/css">
            .datagrid-cell-c1-FIREDEPT_CASENO {
              width: 140px;
            }
            .datagrid-cell-c1-EM_CASE_NO {
              width: 140px;
            }
            .datagrid-cell-c1-CASE_DATE {
              width: 100px;
            }
            .datagrid-cell-c1-CASE_TIME {
              width: 100px;
            }
            .datagrid-cell-c1-MIN_AMBUTIME_1 {
              width: 100px;
            }
            .datagrid-cell-c1-CASE_REASON {
              width: 120px;
            }
            .datagrid-cell-c1-ACCIDENT_AREA {
              width: 120px;
            }
            .datagrid-cell-c1-ACCIDENT_ADDR {
              width: 300px;
            }
            .datagrid-cell-c1-CASE_NO_ENCODE {
              width: auto;
            }
            .datagrid-cell-c1-CASE_LOCK {
              width: auto;
            }
          </style>
        </div>
        <div class="datagrid-pager pagination">
          <table cellspacing="0" cellpadding="0" border="0">
            <tbody>
              <tr>
                <td>
                  <select class="pagination-page-list">
                    <option>10</option>
                    <option>20</option>
                    <option>30</option>
                    <option>40</option>
                    <option>50</option>
                  </select>
                </td>
                <td><div class="pagination-btn-separator"></div></td>
                <td>
                  <a
                    href="javascript:void(0)"
                    class="l-btn l-btn-plain l-btn-disabled l-btn-plain-disabled"
                    group=""
                    id=""
                    ><span class="l-btn-left"
                      ><span class="l-btn-text"
                        ><span class="l-btn-empty pagination-first"
                          >&nbsp;</span
                        ></span
                      ></span
                    ></a
                  >
                </td>
                <td>
                  <a
                    href="javascript:void(0)"
                    class="l-btn l-btn-plain l-btn-disabled l-btn-plain-disabled"
                    group=""
                    id=""
                    ><span class="l-btn-left"
                      ><span class="l-btn-text"
                        ><span class="l-btn-empty pagination-prev"
                          >&nbsp;</span
                        ></span
                      ></span
                    ></a
                  >
                </td>
                <td><div class="pagination-btn-separator"></div></td>
                <td><span style="padding-left: 6px">第</span></td>
                <td>
                  <input
                    class="pagination-num"
                    type="text"
                    value="1"
                    size="2"
                    autocomplete="off"
                  />
                </td>
                <td><span style="padding-right: 6px">共1頁</span></td>
                <td><div class="pagination-btn-separator"></div></td>
                <td>
                  <a
                    href="javascript:void(0)"
                    class="l-btn l-btn-plain l-btn-disabled l-btn-plain-disabled"
                    group=""
                    id=""
                    ><span class="l-btn-left"
                      ><span class="l-btn-text"
                        ><span class="l-btn-empty pagination-next"
                          >&nbsp;</span
                        ></span
                      ></span
                    ></a
                  >
                </td>
                <td>
                  <a
                    href="javascript:void(0)"
                    class="l-btn l-btn-plain l-btn-disabled l-btn-plain-disabled"
                    group=""
                    id=""
                    ><span class="l-btn-left"
                      ><span class="l-btn-text"
                        ><span class="l-btn-empty pagination-last"
                          >&nbsp;</span
                        ></span
                      ></span
                    ></a
                  >
                </td>
                <td><div class="pagination-btn-separator"></div></td>
                <td>
                  <a
                    href="javascript:void(0)"
                    class="l-btn l-btn-plain"
                    group=""
                    id=""
                    ><span class="l-btn-left"
                      ><span class="l-btn-text"
                        ><span class="l-btn-empty pagination-load"
                          >&nbsp;</span
                        ></span
                      ></span
                    ></a
                  >
                </td>
              </tr>
            </tbody>
          </table>
          <div class="pagination-info">顯示0到0筆,共0筆記錄</div>
          <div style="clear: both"></div>
        </div>
        <div>
          <div class="EMSSearchNoData" style="display: block">
            <div class="ResultText">
              <i class="fa fa-file"></i>
              <div>Data Not Found<br />找不到符合條件的資料</div>
            </div>
          </div>
        </div>
        <div>
          <div class="EMSSearchError" style="display: none">
            <div class="ResultText">
              <i class="fa fa-times-circle"></i>
              <div>Get Data Fail<br />資料取得失敗</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div>
      <div class="EMSSearchNoData">
        <div class="ResultText">
          <i class="fa fa-file"></i>
          <div>Data Not Found<br />找不到符合條件的資料</div>
        </div>
      </div>
    </div>
    <div>
      <div class="EMSSearchError">
        <div class="ResultText">
          <i class="fa fa-times-circle"></i>
          <div>Get Data Fail<br />資料取得失敗</div>
        </div>
      </div>
    </div>
  </div>
  <div class="form-search-btns padding-left-35">
    <div class="btn-group" id="ViewBtns" role="group">
      <button
        type="button"
        id="AddBtn"
        class="btn btn-primary"
        onclick="OpenCreateDialog()"
      >
        新增
      </button>
      <button
        type="button"
        id="EditBtn"
        class="btn btn-success"
        onclick="OpenEditDialog()"
      >
        修改
      </button>
      <button
        type="button"
        id="DeleteBtn"
        class="btn btn-danger"
        onclick="OpenDeleteDialog()"
      >
        刪除
      </button>
      <button
        type="button"
        id="DetailBtn"
        class="btn btn-info"
        onclick="OpenDetailDialog()"
      >
        檢視
      </button>
      <button
        type="button"
        id="LinkCaseBtn"
        class="btn btn-primary"
        onclick="OpenAIDCase()"
      >
        連結救護紀錄
      </button>
      <button
        type="button"
        id="LinkCaseBtn"
        class="btn btn-primary"
        onclick="BackAIDCase()"
      >
        返回救護紀錄
      </button>
    </div>
  </div>
  <div class="form-search-ps padding-left-35">
    <ul>
      <li>本表查詢基準：所有未刪除的報案紀錄(不分延號)。</li>
      <li>
        註1.目前鎖定時間以當天建檔日期開始計算，於開放時間（預設24小時）過後即鎖定，各消防局可至系統管理功能之「各縣市救護紀錄表開放時間參數設定」設定開放時間。
      </li>
      <li>
        註2.如欲解除鎖定之分隊請連絡該分隊之局本部或指揮中心相關業務人員，請該人員協助將報案紀錄解除鎖定即可。
      </li>
      <li>
        註3.如單一案件派遣兩個分隊以上時，請連絡局本部或指揮中心相關業務人員，協助將各分隊新增至救護車派遣紀錄中。
      </li>
      <li>
        <span class="text-color-red"
          >註4.新增檢查反應時間異常案件功能，可查詢受理時間小於出勤通知時間之案件。</span
        >
      </li>
      <li>
        <span class="text-color-red"
          >註5.新增檢查有無救護紀錄表案件功能，當刪除救護紀錄表後，派遣紀錄的出勤通知救護人數會變為0，此案件將不列入各項時間統計。</span
        >
      </li>
    </ul>
  </div>
  <div
    class="EMSDialog modal fade in"
    id="CreateDialog"
    tabindex="-1"
    role="dialog"
    aria-labelledby="新增報案紀錄"
    data-keyboard="false"
    aria-hidden="true"
    data-url="/MED1100/Create"
    style="display: block"
  >
    <div class="modal-dialog modal-dialog-centered DialogFull" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">新增報案紀錄</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(true, 'CreateDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button
            type="button"
            class="btn btn-success"
            onclick="CreateEMCase()"
          >
            儲存
          </button>
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(true, 'CreateDialog')"
          >
            關閉
          </button>
          <button
            type="button"
            class="btn btn-info"
            onclick="OpenEmCaseExplain()"
          >
            填寫說明
          </button>
        </div>
        <div class="modal-body">
          <form id="CreateBaseForm">
            <input
              name="__RequestVerificationToken"
              type="hidden"
              value="T7o-11umpdGREYSNWMYW1CVtTYF4NGIm_fSB0fxpqsm9_Vv71ZHpStbTkAqNEQRZc4rviedthUNwoAjZeE7_P4oIP_qixuhdkQ2hmL7VXhbI5p_Le0Pq540GD3snPrUT0"
              autocomplete="off"
            />
            <div class="row">
              <div class="col-md-12 panel panel-none">
                <div class="panel-wrapper collapse in">
                  <div class="panel-body">
                    <div class="form-horizontal">
                      <div class="form-group">
                        <label class="col-sm-2 control-label">指派案號</label>
                        <div class="col-sm-3">
                          <input
                            class="form-control"
                            id="FIREDEPT_CASENO"
                            maxlength="17"
                            name="FIREDEPT_CASENO"
                            placeholder="救災救護指揮中心指派案號"
                            type="text"
                            value=""
                            autocomplete="off"
                          />
                        </div>
                        <label class="col-sm-2 control-label">案號</label>
                        <div class="col-sm-3">
                          <input
                            class="form-control"
                            disabled="disabled"
                            id="EM_CASE_NO"
                            name="EM_CASE_NO"
                            placeholder="緊急醫療管理系統案號"
                            type="text"
                            value=""
                            autocomplete="off"
                          />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label"
                          ><span class="text-color-red">*</span>日期</label
                        >
                        <div class="col-sm-3 control-label">
                          <div class="input-group-A padding-none">
                            <div class="input-group-addon">
                              <i class="zmdi zmdi-calendar-note"></i>
                            </div>
                            <input
                              class="form-control hasDatepicker"
                              id="CASE_DATE"
                              name="CASE_DATE"
                              style="width: 100%"
                              type="text"
                              value="2026-01-13"
                              autocomplete="off"
                            />
                          </div>
                        </div>
                        <label class="col-sm-2 control-label"
                          ><span class="text-color-red">*</span>受理時間</label
                        >
                        <div class="col-sm-3 control-label">
                          <div class="input-group-A padding-none">
                            <div class="input-group-addon">
                              <i class="zmdi zmdi-time"></i>
                            </div>
                            <input
                              class="form-control"
                              id="CASE_TIME"
                              maxlength="5"
                              name="CASE_TIME"
                              onblur="checknewtime()"
                              onkeyup="newtime()"
                              style="width: 100%"
                              type="text"
                              value=""
                              autocomplete="off"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="form-group">
                        <label
                          class="col-sm-2 control-label"
                          title="選擇其它(救護)可填寫其它補述"
                          ><span class="text-color-red">*</span>案由</label
                        >
                        <div class="col-sm-3">
                          <select
                            class="form-control"
                            id="CASE_REASON"
                            name="CASE_REASON"
                          >
                            <option value="">請選擇</option>
                            <option value="11">車禍</option>
                            <option value="12">急病</option>
                            <option value="13">路倒</option>
                            <option value="14">孕婦待產</option>
                            <option value="15">自殺</option>
                            <option value="16">疑似中毒</option>
                            <option value="18">觸電</option>
                            <option value="19">救溺</option>
                            <option value="1A">災害受傷</option>
                            <option value="1Z">其它(救護)</option>
                            <option value="20">疾病</option>
                            <option value="31">車禍處理</option>
                            <option value="33">打殺</option>
                            <option value="3Z">其它(受理轉報)</option>
                          </select>
                        </div>
                        <div class="col-sm-5">
                          <input
                            class="form-control"
                            id="CASE_REASON_OTHER"
                            name="CASE_REASON_OTHER"
                            placeholder="其它補述"
                            type="text"
                            value=""
                            autocomplete="off"
                            style="display: none"
                          />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label">聯絡單位</label>
                        <div class="col-sm-3">
                          <input
                            class="form-control"
                            id="COORDINATOR_DEPT"
                            name="COORDINATOR_DEPT"
                            placeholder="聯絡單位"
                            type="text"
                            value=""
                            autocomplete="off"
                          />
                        </div>
                        <div class="col-sm-6">
                          <button
                            type="button"
                            class="btn"
                            onclick="HotTxtBtn('交通隊')"
                          >
                            交通隊
                          </button>
                          <button
                            type="button"
                            class="btn"
                            onclick="HotTxtBtn('警察局')"
                          >
                            警察局
                          </button>
                          <button
                            type="button"
                            class="btn"
                            onclick="HotTxtBtn('衛生局(所)')"
                          >
                            衛生局(所)
                          </button>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label"
                          ><span class="text-color-red">*</span
                          >發生行政區</label
                        >
                        <div class="col-sm-3">
                          <select
                            class="form-control"
                            id="ACCIDENT_AREA"
                            name="ACCIDENT_AREA"
                          >
                            <option value="">請選擇</option>
                          </select>
                        </div>
                        <label
                          class="col-sm-2 control-label"
                          title="分隊可額外選擇消防局的接報人"
                          ><span class="text-color-red">*</span>接報人</label
                        >
                        <div class="col-sm-3">
                          <select
                            class="form-control select2-hidden-accessible"
                            id="CASE_HOLDER"
                            name="CASE_HOLDER"
                            data-select2-id="CASE_HOLDER"
                            tabindex="-1"
                            aria-hidden="true"
                          >
                            <option value="" data-select2-id="4">
                              請選擇
                            </option></select
                          ><span
                            class="select2 select2-container select2-container--bootstrap"
                            dir="ltr"
                            data-select2-id="3"
                            style="width: 372px"
                            ><span class="selection"
                              ><span
                                class="select2-selection select2-selection--single"
                                role="combobox"
                                aria-haspopup="true"
                                aria-expanded="false"
                                tabindex="0"
                                aria-labelledby="select2-CASE_HOLDER-container"
                                ><span
                                  class="select2-selection__rendered"
                                  id="select2-CASE_HOLDER-container"
                                  role="textbox"
                                  aria-readonly="true"
                                  ><span class="select2-selection__placeholder"
                                    >接報人</span
                                  ></span
                                ><span
                                  class="select2-selection__arrow"
                                  role="presentation"
                                  ><b
                                    role="presentation"
                                  ></b></span></span></span
                            ><span
                              class="dropdown-wrapper"
                              aria-hidden="true"
                            ></span
                          ></span>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label"
                          ><span class="text-color-red">*</span
                          >詳細發生地點</label
                        >
                        <div class="col-sm-8">
                          <input
                            class="form-control"
                            id="ACCIDENT_ADDR"
                            name="ACCIDENT_ADDR"
                            placeholder="詳細發生地點"
                            type="text"
                            value=""
                            autocomplete="off"
                          />
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label">事故路段</label>
                        <div class="col-sm-8 checkbox-list">
                          <input
                            class="form-control"
                            id="ACCIDENT_ROUTE"
                            name="ACCIDENT_ROUTE"
                            placeholder="事故路段"
                            type="text"
                            value=""
                            autocomplete="off"
                          />
                          <input
                            type="checkbox"
                            id="ACCIDENT_ROUTE_CB"
                            autocomplete="off"
                          /><label class="control-label" for="ACCIDENT_ROUTE_CB"
                            >同詳細發生地點</label
                          >
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label">備註</label>
                        <div class="col-sm-8">
                          <textarea
                            class="form-control"
                            cols="20"
                            id="CASE_REMARK"
                            name="CASE_REMARK"
                            placeholder="備註"
                            rows="3"
                          ></textarea>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label">申請人區分</label>
                        <div class="col-sm-3">
                          <select
                            class="form-control"
                            id="CALLER_DEFINE"
                            name="CALLER_DEFINE"
                          >
                            <option value="">請選擇</option>
                            <option value="1">本人</option>
                            <option value="2">家屬</option>
                            <option value="3">他人</option>
                          </select>
                        </div>
                        <label class="col-sm-2 control-label">申請人姓名</label>
                        <div class="col-sm-3">
                          <input
                            class="form-control"
                            id="CASE_CALLER"
                            name="CASE_CALLER"
                            placeholder="申請人姓名"
                            type="text"
                            value=""
                            autocomplete="off"
                          />
                        </div>
                        <div class="col-sm-2">
                          <button
                            type="button"
                            class="btn"
                            onclick="NameTxtBtn('不詳')"
                          >
                            不詳
                          </button>
                          <button
                            type="button"
                            class="btn"
                            onclick="NameTxtBtn('不願具名')"
                          >
                            不願具名
                          </button>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label">申請人電話</label>
                        <div class="col-sm-3">
                          <input
                            class="form-control"
                            id="CALLER_PHONE"
                            name="CALLER_PHONE"
                            placeholder="申請人電話"
                            type="text"
                            value=""
                            autocomplete="off"
                          />
                        </div>
                        <label class="col-sm-2 control-label">申請人性別</label>
                        <div class="col-sm-3">
                          <select
                            class="form-control"
                            id="CALLER_SEX"
                            name="CALLER_SEX"
                          >
                            <option value="">請選擇</option>
                            <option value="1">男</option>
                            <option value="2">女</option>
                            <option value="4">不明</option>
                          </select>
                        </div>
                      </div>
                      <div class="form-group">
                        <label class="col-sm-2 control-label">申請人住址</label>
                        <div class="col-sm-8">
                          <div class="col-sm-12 list-inline">
                            <select
                              class="form-control inline"
                              id="CALLER_COUNTY"
                              name="CALLER_COUNTY"
                              style="width: 110px"
                            >
                              <option value="">請選擇</option>
                              <option value="11">基隆市</option>
                              <option value="31">新北市</option>
                              <option value="01">台北市</option>
                              <option value="32">桃園市</option>
                              <option value="33">新竹縣</option>
                              <option value="12">新竹市</option>
                              <option value="35">苗栗縣</option>
                              <option value="03">台中市</option>
                              <option value="37">彰化縣</option>
                              <option value="38">南投縣</option>
                              <option value="39">雲林縣</option>
                              <option value="40">嘉義縣</option>
                              <option value="22">嘉義市</option>
                              <option value="05">台南市</option>
                              <option value="07">高雄市</option>
                              <option value="43">屏東縣</option>
                              <option value="34">宜蘭縣</option>
                              <option value="45">花蓮縣</option>
                              <option value="46">台東縣</option>
                              <option value="44">澎湖縣</option>
                              <option value="91">連江縣</option>
                              <option value="90">金門縣</option>
                            </select>
                            <select
                              class="form-control inline"
                              id="CALLER_TOWN"
                              name="CALLER_TOWN"
                              style="width: 140px"
                            >
                              <option value="">請選擇</option>
                            </select>
                            <input
                              class="form-control inline"
                              id="CALLER_ADDR"
                              name="CALLER_ADDR"
                              placeholder="申請人住址"
                              style="
                                width: calc(100% - 260px);
                                min-width: 400px;
                              "
                              type="text"
                              value=""
                              autocomplete="off"
                            />
                          </div>
                        </div>
                      </div>
                      <div class="form-group">
                        <div class="col-sm-10">
                          <div class="tab-struct" data-toggle="tab-container">
                            <ul class="nav nav-tabs">
                              <li class="active">
                                <a
                                  aria-expanded="true"
                                  data-toggle="tab"
                                  role="tab"
                                  title="救護車派遣紀錄"
                                  id="Ambulance_Tab"
                                  href="#Ambulance"
                                  ><i
                                    class="fa fa-ambulance mr-10"
                                    style="color: red"
                                  ></i
                                  >救護車派遣紀錄</a
                                >
                              </li>
                              <li class="next">
                                <a
                                  data-toggle="tab"
                                  role="tab"
                                  title="服務車輛派遣記錄"
                                  id="Service_Tab"
                                  href="#Service"
                                  aria-expanded="false"
                                  ><i
                                    class="fa fa-truck mr-10 text-color-red"
                                  ></i
                                  >服務車輛派遣記錄</a
                                >
                              </li>
                            </ul>
                            <div
                              class="tab-content"
                              style="
                                overflow-x: hidden;
                                overflow-y: auto;
                                min-height: 160px;
                              "
                            >
                              <div
                                id="Ambulance"
                                class="tab-pane fade active in"
                              >
                                <div class="btn-group">
                                  <button
                                    type="button"
                                    class="btn btn-primary"
                                    onclick="AddAmbulanceItem()"
                                  >
                                    新增
                                  </button>
                                  <button
                                    type="button"
                                    class="btn btn-danger"
                                    id="DelAmbulanceBtn"
                                    onclick="DeleteAmbulanceItem()"
                                    disabled=""
                                  >
                                    刪除
                                  </button>
                                </div>
                                <div
                                  class="datagrid-box col-sm-12 padding-none mt-5 datagrid-single-select panel-noscroll"
                                  style="height: 150px"
                                >
                                  <div
                                    class="panel datagrid"
                                    style="width: 1298px"
                                  >
                                    <div
                                      class="datagrid-wrap panel-body panel-body-noheader"
                                      title=""
                                      id=""
                                      style="width: 1296px; height: 148px"
                                    >
                                      <div
                                        class="datagrid-view"
                                        style="width: 1296px; height: 148px"
                                      >
                                        <div
                                          class="datagrid-view1"
                                          style="width: 59px"
                                        >
                                          <div
                                            class="datagrid-header"
                                            style="width: 59px; height: 55px"
                                          >
                                            <div
                                              class="datagrid-header-inner"
                                              style="display: block"
                                            >
                                              <table
                                                class="datagrid-htable"
                                                border="0"
                                                cellspacing="0"
                                                cellpadding="0"
                                                style="height: 55px"
                                              >
                                                <tbody>
                                                  <tr
                                                    class="datagrid-header-row"
                                                  >
                                                    <td rowspan="1">
                                                      <div
                                                        class="datagrid-header-rownumber"
                                                      ></div>
                                                    </td>
                                                    <td field="checkbox">
                                                      <div
                                                        class="datagrid-header-check"
                                                      >
                                                        <input
                                                          type="checkbox"
                                                        />
                                                      </div>
                                                    </td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                            </div>
                                          </div>
                                          <div
                                            class="datagrid-body"
                                            style="
                                              width: 59px;
                                              margin-top: 0px;
                                              height: 93px;
                                            "
                                          >
                                            <div
                                              class="datagrid-body-inner"
                                            ></div>
                                          </div>
                                          <div
                                            class="datagrid-footer"
                                            style="width: 59px"
                                          >
                                            <div
                                              class="datagrid-footer-inner"
                                              style="display: none"
                                            ></div>
                                          </div>
                                        </div>
                                        <div
                                          class="datagrid-view2"
                                          style="width: 1237px"
                                        >
                                          <div
                                            class="datagrid-header"
                                            style="width: 1237px; height: 55px"
                                          >
                                            <div
                                              class="datagrid-header-inner"
                                              style="display: block"
                                            >
                                              <table
                                                class="datagrid-htable"
                                                border="0"
                                                cellspacing="0"
                                                cellpadding="0"
                                                style="height: 55px"
                                              >
                                                <tbody>
                                                  <tr
                                                    class="datagrid-header-row"
                                                  >
                                                    <td
                                                      field="AMBULANCE_AMBU_INFORM_DATE"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c2-AMBULANCE_AMBU_INFORM_DATE"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>出勤通知日期</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="AMBULANCE_AMBU_INFORM_TIME"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c2-AMBULANCE_AMBU_INFORM_TIME"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>出勤通知時間</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="AMBULANCE_DEPT_NAME"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c2-AMBULANCE_DEPT_NAME"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>出勤單位</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="AMBULANCE_AMBU_NAME"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c2-AMBULANCE_AMBU_NAME"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>救護車代號</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="AMBULANCE_SERVICE_TIMES"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c2-AMBULANCE_SERVICE_TIMES"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span
                                                          >出勤通知救護人數</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="AMBULANCE_DEPT_NO"
                                                      style="display: none"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c2-AMBULANCE_DEPT_NO"
                                                      >
                                                        <span>undefined</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="AMBULANCE_AMBU_NO"
                                                      style="display: none"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c2-AMBULANCE_AMBU_NO"
                                                      >
                                                        <span>undefined</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                            </div>
                                          </div>
                                          <div
                                            class="datagrid-body"
                                            style="
                                              width: 1237px;
                                              margin-top: 0px;
                                              height: 93px;
                                            "
                                          ></div>
                                          <div
                                            class="datagrid-footer"
                                            style="width: 1237px"
                                          >
                                            <div
                                              class="datagrid-footer-inner"
                                              style="display: none"
                                            ></div>
                                          </div>
                                        </div>
                                        <table
                                          class="EMSDataGrid"
                                          id="Create_EMCaseAmbulance"
                                          style="height: auto; display: none"
                                          data-options="rownumbers:true,singleSelect:true,fit:true"
                                        ></table>
                                        <style type="text/css">
                                          .datagrid-cell-c2-AMBULANCE_AMBU_INFORM_DATE {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c2-AMBULANCE_AMBU_INFORM_TIME {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c2-AMBULANCE_DEPT_NAME {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c2-AMBULANCE_AMBU_NAME {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c2-AMBULANCE_SERVICE_TIMES {
                                            width: 130px;
                                          }
                                          .datagrid-cell-c2-AMBULANCE_DEPT_NO {
                                            width: auto;
                                          }
                                          .datagrid-cell-c2-AMBULANCE_AMBU_NO {
                                            width: auto;
                                          }
                                        </style>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="clearfix"></div>
                              </div>
                              <div id="Service" class="tab-pane fade">
                                <div class="btn-group">
                                  <button
                                    type="button"
                                    class="btn btn-primary"
                                    onclick="AddServiceItem()"
                                  >
                                    新增
                                  </button>
                                  <button
                                    type="button"
                                    class="btn btn-danger"
                                    id="DelServiceCarBtn"
                                    onclick="DeleteServiceCarItem()"
                                    disabled=""
                                  >
                                    刪除
                                  </button>
                                </div>
                                <div
                                  class="datagrid-box col-sm-12 padding-none mt-5 datagrid-single-select panel-noscroll"
                                  style="height: 150px"
                                >
                                  <div
                                    class="panel datagrid"
                                    style="width: 0px"
                                  >
                                    <div
                                      class="datagrid-wrap panel-body panel-body-noheader"
                                      title=""
                                      id=""
                                      style="width: 0px; height: 148px"
                                    >
                                      <div
                                        class="datagrid-view"
                                        style="width: 0px; height: 0px"
                                      >
                                        <div
                                          class="datagrid-view1"
                                          style="width: 0px"
                                        >
                                          <div
                                            class="datagrid-header"
                                            style="width: 0px; height: 0px"
                                          >
                                            <div
                                              class="datagrid-header-inner"
                                              style="display: block"
                                            >
                                              <table
                                                class="datagrid-htable"
                                                border="0"
                                                cellspacing="0"
                                                cellpadding="0"
                                                style="height: 0px"
                                              >
                                                <tbody>
                                                  <tr
                                                    class="datagrid-header-row"
                                                  >
                                                    <td rowspan="1">
                                                      <div
                                                        class="datagrid-header-rownumber"
                                                      ></div>
                                                    </td>
                                                    <td field="checkbox">
                                                      <div
                                                        class="datagrid-header-check"
                                                      >
                                                        <input
                                                          type="checkbox"
                                                        />
                                                      </div>
                                                    </td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                            </div>
                                          </div>
                                          <div
                                            class="datagrid-body"
                                            style="
                                              width: 0px;
                                              margin-top: 0px;
                                              height: 148px;
                                            "
                                          >
                                            <div
                                              class="datagrid-body-inner"
                                            ></div>
                                          </div>
                                          <div
                                            class="datagrid-footer"
                                            style="width: 0px"
                                          >
                                            <div
                                              class="datagrid-footer-inner"
                                              style="display: none"
                                            ></div>
                                          </div>
                                        </div>
                                        <div
                                          class="datagrid-view2"
                                          style="width: 0px"
                                        >
                                          <div
                                            class="datagrid-header"
                                            style="width: 0px; height: 0px"
                                          >
                                            <div
                                              class="datagrid-header-inner"
                                              style="display: block"
                                            >
                                              <table
                                                class="datagrid-htable"
                                                border="0"
                                                cellspacing="0"
                                                cellpadding="0"
                                                style="height: 0px"
                                              >
                                                <tbody>
                                                  <tr
                                                    class="datagrid-header-row"
                                                  >
                                                    <td
                                                      field="SERVICE_SERV_INFORM_DATE"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c3-SERVICE_SERV_INFORM_DATE"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>出勤通知日期</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="SERVICE_SERV_INFORM_TIME"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c3-SERVICE_SERV_INFORM_TIME"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>出勤通知時間</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="SERVICE_DEPT_NAME"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c3-SERVICE_DEPT_NAME"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>出勤單位</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td field="SERVICE_SERV_NO">
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c3-SERVICE_SERV_NO"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>車輛代號</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="SERVICE_SERV_NAME"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c3-SERVICE_SERV_NAME"
                                                        style="
                                                          text-align: center;
                                                        "
                                                      >
                                                        <span>車輛類型</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                    <td
                                                      field="SERVICE_DEPT_NO"
                                                      style="display: none"
                                                    >
                                                      <div
                                                        class="datagrid-cell datagrid-cell-c3-SERVICE_DEPT_NO"
                                                      >
                                                        <span>undefined</span
                                                        ><span
                                                          class="datagrid-sort-icon"
                                                          >&nbsp;</span
                                                        >
                                                      </div>
                                                    </td>
                                                  </tr>
                                                </tbody>
                                              </table>
                                            </div>
                                          </div>
                                          <div
                                            class="datagrid-body"
                                            style="
                                              width: 0px;
                                              margin-top: 0px;
                                              height: 148px;
                                            "
                                          ></div>
                                          <div
                                            class="datagrid-footer"
                                            style="width: 0px"
                                          >
                                            <div
                                              class="datagrid-footer-inner"
                                              style="display: none"
                                            ></div>
                                          </div>
                                        </div>
                                        <table
                                          class="EMSDataGrid"
                                          id="Create_EMCaseService"
                                          style="height: auto; display: none"
                                          data-options="rownumbers:true,singleSelect:true,fit:true"
                                        ></table>
                                        <style type="text/css">
                                          .datagrid-cell-c3-SERVICE_SERV_INFORM_DATE {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c3-SERVICE_SERV_INFORM_TIME {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c3-SERVICE_DEPT_NAME {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c3-SERVICE_SERV_NO {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c3-SERVICE_SERV_NAME {
                                            width: 100px;
                                          }
                                          .datagrid-cell-c3-SERVICE_DEPT_NO {
                                            width: auto;
                                          }
                                        </style>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="clearfix"></div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </form>
          <script>
            $(document).ready(function () {
              EMSInputAutoOff();
              HtmlInputInit();
              CreateInputInit();
              CreateEMDataGridInit();
              AutoInputArea();
              var form = $("#CreateBaseForm");

              form.find("#CASE_HOLDER").select2({
                language: "zh-TW",
                theme: "bootstrap",
                placeholder: "接報人",
                language: {
                  noResults: function (params) {
                    return "查無資料";
                  },
                },
              });
            });
            $(window).resize(function () {
              var form = $("#CreateBaseForm");
              form.find("#Create_EMCaseAmbulance").datagrid("resize");
              form.find("#Create_EMCaseService").datagrid("resize");
            });
            function newtime() {
              var timeObj = document.getElementById("CASE_TIME").value;

              if (timeObj.length == 2) {
                document.getElementById("CASE_TIME").value = timeObj + ":";
              }
              //if (timeObj.length == 5) {
              //    document.getElementById("CASE_TIME").value = timeObj + ":00";
              //}
            }
            function checknewtime() {
              var patm = /^([0-1][0-9]|2[0-3]):[0-5][0-9]$/;
              if (!patm.exec(document.getElementById("CASE_TIME").value)) {
                document.getElementById("CASE_TIME").focus();
                document.getElementById("CASE_TIME").select();
                document.getElementById("CASE_TIME").value = "";
              }
            }
            function CreateInputInit() {
              var form = $("#CreateBaseForm");

              form.find("#CASE_REASON").on("change", function () {
                if ($(this).val() != "1Z") {
                  form.find("#CASE_REASON_OTHER").val("");
                  form.find("#CASE_REASON_OTHER").hide();
                } else {
                  form.find("#CASE_REASON_OTHER").show();
                }
              });
              form.find("#Ambulance_Tab").on("shown.bs.tab", function () {
                form.find("#Create_EMCaseAmbulance").datagrid("resize");
              });
              form.find("#Service_Tab").on("shown.bs.tab", function () {
                form.find("#Create_EMCaseService").datagrid("resize");
              });
              //form.find('#ACCIDENT_ADDR_CB').on('change', function () {
              //    if ($(this).is(':checked')) {
              //        form.find('#CALLER_TOWN').val(form.find('#ACCIDENT_AREA').val());
              //    }
              //});
              form.find("#ACCIDENT_ROUTE_CB").on("change", function () {
                if ($(this).is(":checked")) {
                  form
                    .find("#ACCIDENT_ROUTE")
                    .val(form.find("#ACCIDENT_ADDR").val());
                }
              });
              form.find("#CALLER_COUNTY").on("change", function () {
                var CountyID = $(this).val();

                EMS_ReloadSelect(
                  "/Common/getCountyTownList" + "?CountyID=" + CountyID,
                  "CALLER_TOWN",
                );
              });

              form.find("#CASE_REASON").trigger("change");
              form.find("#CALLER_COUNTY").trigger("change");
            }
            function CreateEMDataGridInit() {
              var form = $("#CreateBaseForm");

              form.find("#Create_EMCaseAmbulance").datagrid({
                pagination: false,
                onSelect: function (index, row) {
                  form.find("#DelAmbulanceBtn").prop("disabled", false);
                },
                frozenColumns: [
                  [
                    {
                      field: "checkbox",
                      halign: "center",
                      checkbox: true,
                      align: "center",
                      width: "50",
                    },
                  ],
                ],
                columns: [
                  [
                    {
                      field: "AMBULANCE_AMBU_INFORM_DATE",
                      title: "出勤通知日期",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "AMBULANCE_AMBU_INFORM_TIME",
                      title: "出勤通知時間",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "AMBULANCE_DEPT_NAME",
                      title: "出勤單位",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "AMBULANCE_AMBU_NAME",
                      title: "救護車代號",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "AMBULANCE_SERVICE_TIMES",
                      title: "出勤通知救護人數",
                      halign: "center",
                      align: "center",
                      width: "130",
                    },
                    { field: "AMBULANCE_DEPT_NO", hidden: true },
                    { field: "AMBULANCE_AMBU_NO", hidden: true },
                  ],
                ],
              });
              form.find("#Create_EMCaseService").datagrid({
                pagination: false,
                onSelect: function (index, row) {
                  form.find("#DelServiceCarBtn").prop("disabled", false);
                },
                frozenColumns: [
                  [
                    {
                      field: "checkbox",
                      halign: "center",
                      checkbox: true,
                      align: "center",
                      width: "50",
                    },
                  ],
                ],
                columns: [
                  [
                    {
                      field: "SERVICE_SERV_INFORM_DATE",
                      title: "出勤通知日期",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "SERVICE_SERV_INFORM_TIME",
                      title: "出勤通知時間",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "SERVICE_DEPT_NAME",
                      title: "出勤單位",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "SERVICE_SERV_NO",
                      title: "車輛代號",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    {
                      field: "SERVICE_SERV_NAME",
                      title: "車輛類型",
                      halign: "center",
                      align: "center",
                      width: "100",
                    },
                    { field: "SERVICE_DEPT_NO", hidden: true },
                  ],
                ],
              });
            }
            //聯絡單位可重複填入按鈕
            function HotTxtBtn(hot_txt) {
              $("#CreateBaseForm")
                .find("#COORDINATOR_DEPT")
                .val(function HotTxtBtn(n, txt) {
                  return txt + hot_txt + ",";
                });
            }
            //申請人姓名不詳按鈕
            function NameTxtBtn(hot_txt) {
              $("#CreateBaseForm").find("#CASE_CALLER").val(hot_txt);
            }
            //詳細發生地點與申請人住址自動帶入發生之行政區選項
            function AutoInputArea() {
              var form = $("#CreateBaseForm");
              if (form.find("#ACCIDENT_ADDR").val() == "") {
                form.find("#ACCIDENT_AREA").on("change", function () {
                  if ($(this).val() != "") {
                    form
                      .find("#ACCIDENT_ADDR")
                      .val(
                        form
                          .find("#ACCIDENT_AREA")
                          .find("option:selected")
                          .text(),
                      );
                  }
                });
              }
              if (form.find("#CALLER_TOWN").val() == "") {
                form.find("#ACCIDENT_AREA").on("change", function () {
                  if ($(this).val() != "") {
                    form
                      .find("#CALLER_TOWN")
                      .val(form.find("#ACCIDENT_AREA").val());
                  }
                });
              }
              form.find("#ACCIDENT_AREA").trigger("change");
            }
            function AddAmbulanceItem() {
              EMS_OpenDialog(
                "AddAmbulanceDialog",
                "/MED1100/Ambulance",
                function () {
                  setAmbulanceComplete(AmbulanceItemComp);
                },
              );
            }
            function AddServiceItem() {
              EMS_OpenDialog(
                "AddServiceCarDialog",
                "/MED1100/ServiceCar",
                function () {
                  setServiceComplete(ServiceItemComp);
                },
              );
            }
            function AmbulanceItemComp(ambulance_data) {
              var form = $("#CreateBaseForm");
              var isItem = false;
              var DgNowRows = EMS_getDataGridRows("Create_EMCaseAmbulance");
              var row = {
                AMBULANCE_AMBU_INFORM_DATE: ambulance_data["INFORM_DATE"],
                AMBULANCE_AMBU_INFORM_TIME: ambulance_data["INFORM_TIME"],
                AMBULANCE_SERVICE_TIMES: ambulance_data["SERVICE_TIMES"],
                AMBULANCE_DEPT_NAME: ambulance_data["DEPT_NAME"],
                AMBULANCE_DEPT_NO: ambulance_data["DEPT_NO"],
                AMBULANCE_AMBU_NAME: ambulance_data["AMBU_NAME"],
                AMBULANCE_AMBU_NO: ambulance_data["AMBU_NO"],
              };

              $.each(DgNowRows, function (index, item) {
                if (
                  item.AMBULANCE_AMBU_INFORM_DATE ==
                    ambulance_data["INFORM_DATE"] &&
                  item.AMBULANCE_AMBU_INFORM_TIME ==
                    ambulance_data["INFORM_TIME"] &&
                  item.AMBULANCE_DEPT_NO == ambulance_data["DEPT_NO"] &&
                  item.AMBULANCE_AMBU_NO == ambulance_data["AMBU_NO"]
                ) {
                  isItem = true;
                  return false;
                }
              });

              if (isItem) {
                $.messager.alert(
                  "新增報案紀錄",
                  "此筆資料已存在，不可重複新增",
                );
                return;
              }

              EMS_CloseDialog(false, "AddAmbulanceDialog");
              form.find("#Create_EMCaseAmbulance").datagrid("appendRow", row);
            }
            function ServiceItemComp(service_data) {
              var row = {
                SERVICE_SERV_INFORM_DATE: service_data["INFORM_DATE"],
                SERVICE_SERV_INFORM_TIME: service_data["INFORM_TIME"],
                SERVICE_DEPT_NAME: service_data["DEPT_NAME"],
                SERVICE_DEPT_NO: service_data["DEPT_NO"],
                SERVICE_SERV_NAME: service_data["SERVICE_NAME"],
                SERVICE_SERV_NO: service_data["SERVICE_NO"],
              };

              EMS_CloseDialog(false, "AddServiceCarDialog");
              $("#CreateBaseForm")
                .find("#Create_EMCaseService")
                .datagrid("appendRow", row);
            }
            function DeleteAmbulanceItem() {
              var SelectRowIndex = EMS_getDataGridSelectRowIndex(
                "Create_EMCaseAmbulance",
              );

              if (SelectRowIndex == -1) {
                $.messager.alert("新增報案紀錄", "請選擇救護車派遣紀錄");
                return;
              }

              $("#CreateBaseForm")
                .find("#Create_EMCaseAmbulance")
                .datagrid("deleteRow", SelectRowIndex);
            }
            function DeleteServiceCarItem() {
              var SelectRowIndex = EMS_getDataGridSelectRowIndex(
                "Create_EMCaseService",
              );

              if (SelectRowIndex == -1) {
                $.messager.alert("新增報案紀錄", "請選擇服務車輛派遣紀錄");
                return;
              }

              $("#CreateBaseForm")
                .find("#Create_EMCaseService")
                .datagrid("deleteRow", SelectRowIndex);
            }
            function OpenEmCaseExplain() {
              OpenEMSDialogNoURL("EmCaseExplainDialog");
            }
            function CreateEMCase() {
              if (!CreatechkForm()) return;

              $.messager.confirm(
                "新增報案紀錄",
                "確定要新增報案紀錄?",
                function (r) {
                  if (r) {
                    var TransData = getSerialzeData("CreateBaseForm");
                    ConvertArray(
                      "AmbulanceList",
                      "Create_EMCaseAmbulance",
                      TransData,
                    );
                    ConvertArray(
                      "ServiceList",
                      "Create_EMCaseService",
                      TransData,
                    );

                    PageDataAjax(
                      true,
                      "/MED1100/Create",
                      TransData,
                      CreateSuccess,
                    );
                  }
                },
              );
            }
            function CreatechkForm() {
              var form = $("#CreateBaseForm");
              var DgNowRows = EMS_getDataGridRows("Create_EMCaseAmbulance");

              //判斷有無救護車派遣紀錄
              if (DgNowRows[0] == null) {
                $.messager.alert("新增報案紀錄", "請輸入救護車派遣紀錄");
                return false;
              }
              //判斷受理時間是否大於救護車出勤通知時間
              if (
                $.trim(form.find("#CASE_TIME").val()).substring(0, 5) >
                  DgNowRows[0].AMBULANCE_AMBU_INFORM_TIME &&
                $.trim(form.find("#CASE_DATE").val()) ==
                  DgNowRows[0].SERVICE_SERV_INFORM_DATE
              ) {
                $.messager.alert(
                  "新增報案紀錄",
                  "受理時間是" +
                    $.trim(form.find("#CASE_TIME").val()).substring(0, 5) +
                    "，大於救護車出勤通知時間" +
                    DgNowRows[0].AMBULANCE_AMBU_INFORM_TIME,
                );
                return false;
              }
              if ($.trim(form.find("#CASE_DATE").val()) == "") {
                $.messager.alert("新增報案紀錄", "請輸入報案日期");
                return false;
              }
              if ($.trim(form.find("#CASE_TIME").val()) == "") {
                $.messager.alert("新增報案紀錄", "請輸入受理時間");
                return false;
              }
              if ($.trim(form.find("#CASE_REASON").val()) == "") {
                $.messager.alert("新增報案紀錄", "請選擇案由");
                return false;
              }
              if (
                $.trim(form.find("#CASE_REASON").val()) == "1Z" &&
                $.trim(form.find("#CASE_REASON_OTHER").val()) == ""
              ) {
                $.messager.alert("新增報案紀錄", "請輸入其它案由的補述");
                return false;
              }
              if ($.trim(form.find("#CASE_HOLDER").val()) == "") {
                $.messager.alert("新增報案紀錄", "請選擇接報人");
                return false;
              }

              if ($.trim(form.find("#ACCIDENT_AREA").val()) == "") {
                $.messager.alert("新增報案紀錄", "請選擇發生之行政區");
                return false;
              }
              if ($.trim(form.find("#ACCIDENT_ADDR").val()) == "") {
                $.messager.alert("新增報案紀錄", "請輸入詳細發生地點");
                return false;
              }
              if (
                form.find("#Create_EMCaseAmbulance").datagrid("getRows")
                  .length == 0 &&
                form.find("#Create_EMCaseService").datagrid("getRows").length ==
                  0
              ) {
                $.messager.alert(
                  "新增報案紀錄",
                  "請至少輸入一筆「救護車」或「服務車輛」派遣紀錄",
                );
                return false;
              }

              return true;
            }
            function CreateSuccess(response) {
              if (response.Success) {
                $.messager.alert("新增報案紀錄", "報案紀錄新增成功");
                EMS_CloseDialog(false, "CreateDialog");
                EMS_SearchDataGrid("SearchDataGridList");
              } else {
                $.messager.alert("新增報案紀錄", response.Message);
              }
            }
          </script>
        </div>
      </div>
    </div>
  </div>
  <div
    class="EMSDialog modal fade"
    id="EditDialog"
    tabindex="-1"
    role="dialog"
    aria-labelledby="修改報案紀錄"
    data-keyboard="false"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered DialogFull" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">修改報案紀錄</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(true, 'EditDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button type="button" class="btn btn-success" onclick="EditEMCase()">
            儲存
          </button>
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(true, 'EditDialog')"
          >
            關閉
          </button>
          <button
            type="button"
            class="btn btn-info"
            onclick="OpenEmCaseExplain()"
          >
            填寫說明
          </button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
  <div
    class="EMSDialog modal fade"
    id="DetailDialog"
    tabindex="-1"
    role="dialog"
    aria-labelledby="檢視報案紀錄"
    data-keyboard="false"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered DialogFull" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">檢視報案紀錄</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(false, 'DetailDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(false, 'DetailDialog')"
          >
            關閉
          </button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
  <div
    class="EMSDialog modal fade"
    id="DeleteDialog"
    tabindex="-1"
    role="dialog"
    aria-labelledby="刪除報案紀錄"
    data-keyboard="false"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered DialogFull" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">刪除報案紀錄</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(true, 'DeleteDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button type="button" class="btn btn-danger" onclick="DeleteEMase()">
            刪除
          </button>
          <button
            type="button"
            class="btn btn-primary"
            onclick="EMS_CloseDialog(true, 'DeleteDialog')"
          >
            關閉
          </button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
  <div
    class="EMSDialog modal fade model-bgA"
    id="AddAmbulanceDialog"
    tabindex="-1"
    role="dialog"
    aria-labelledby="新增救護車派遣紀錄"
    aria-hidden="true"
  >
    <div
      class="modal-dialog modal-dialog-centered DialogFull-Mobile"
      role="document"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">新增救護車派遣紀錄</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(true, 'AddAmbulanceDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button
            type="button"
            class="btn btn-primary"
            onclick="AddAmbulanceComplete()"
          >
            新增
          </button>
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(true, 'AddAmbulanceDialog')"
          >
            關閉
          </button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
  <div
    class="EMSDialog modal fade model-bgA"
    id="AddServiceCarDialog"
    tabindex="-1"
    role="dialog"
    aria-labelledby="新增服務車輛派遣紀錄"
    aria-hidden="true"
  >
    <div
      class="modal-dialog modal-dialog-centered DialogFull-Mobile"
      role="document"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">新增服務車輛派遣紀錄</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(true, 'AddServiceCarDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button
            type="button"
            class="btn btn-primary"
            onclick="AddServiceComplete()"
          >
            新增
          </button>
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(true, 'AddServiceCarDialog')"
          >
            關閉
          </button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>
  <div
    class="EMSDialog modal fade"
    id="EmCaseExplainDialog"
    role="dialog"
    aria-labelledby="報案紀錄填寫說明"
    data-keyboard="false"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">報案紀錄填寫說明</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(false, 'EmCaseExplainDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(false, 'EmCaseExplainDialog')"
          >
            關閉
          </button>
        </div>
        <div class="modal-body">
          <div class="col-sm-12">
            <div class="form-group">
              <ul style="line-height: 1.6em">
                <li>
                  1.標示「<span class="text-color-red">*</span
                  >」之欄位因統計所需，表示為必填
                </li>
                <li>
                  2.配合新版救護紀錄表，新增<span class="text-color-red"
                    >救災救護指揮中心指派案號</span
                  >欄位，格式：17碼數字（前14碼是年月日時分秒，後3碼是流水號）。
                </li>
                <li>
                  3.配合新版救護紀錄表，原報案時間更改為<span
                    class="text-color-red"
                    >受理時間</span
                  >，並改回輸入方式填寫，填寫時、分即可。
                </li>
                <li>
                  4.配合派遣系統介接，未分類之案由均列為<span
                    class="text-color-red"
                    >其他(救護)</span
                  >，填寫其他補述欄位中，接報人則會顯示為<span
                    class="text-color-red"
                    >「該縣市指揮中心」</span
                  >。
                </li>
                <li>
                  5.<span class="text-color-red">接報人</span
                  >可利用姓名搜尋，分隊填報時可額外選擇消防局的接報人，新增報案紀錄時僅顯示<span
                    class="text-color-red"
                    >在勤且未被刪除註記</span
                  >之人員，修改時則會顯示<span class="text-color-red"
                    >未被刪除註記</span
                  >之人員。
                </li>
                <li>
                  6.<span class="text-color-red">聯絡單位</span
                  >可重複點選不同單位，也可自行加入。
                </li>
                <li>
                  7.選擇<span class="text-color-red">發生行政區</span
                  >會自動帶入詳細發生地點內，如果有跨縣市案件，可至"案件發生地之鄰近縣市設定"功能設定。
                </li>
                <li>
                  8.申請人區分、申請人姓名、申請人性別、申請人電話與申請人住址改為<span
                    class="text-color-red"
                    >非必填</span
                  >。
                </li>
                <li>
                  9.新增救護車派遣紀錄時，會自動帶入<span class="text-color-red"
                    >受理時間</span
                  >，並檢核"出勤通知日期不可小於報案日期"及"出勤通知時間不可小於受理時間"。
                </li>
                <li>
                  10.<span class="text-color-red">出勤通知救護人數</span
                  >空跑或拒送的案件也需要填寫人數才可產出救護紀錄表，不可填寫"0"人，如：1人送醫1人拒送的案件需填寫"2"。
                </li>
                <li>
                  11.<span class="text-color-red">救護車代號</span>或<span
                    class="text-color-red"
                    >車牌號碼</span
                  >如果顯示null或錯誤，請聯絡當地衛生局或系統客服協助補登、修改救護車資料。
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div
    class="EMSDialog modal fade"
    id="AidCaseExplainDialog"
    role="dialog"
    aria-labelledby="救護紀錄填寫說明"
    data-keyboard="false"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">救護紀錄填寫說明</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(true, 'AidCaseExplainDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(true, 'AidCaseExplainDialog')"
          >
            關閉
          </button>
        </div>
        <div class="modal-body">
          <div class="col-sm-12">
            <div class="form-group">
              <ul style="line-height: 1.6em">
                <li>
                  標示「<span class="text-color-red">*</span
                  >」之欄位，表示為必填
                </li>
                <li>
                  標示「<span class="text-color-red">$</span
                  >」之欄位，表示「未選擇未送醫原因」(非空跑)時則必填
                </li>
                <li>
                  標示「<span class="text-color-red">#</span
                  >」之欄位，表示「有選擇未送醫原因」(空跑)時則必填
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    $(document).ready(function () {
      BreadCrumbNav("MED1100");
      EMSTrack("MED1100");
      EMSInputAutoOff();
      SearchDataGridInit();
      AutoInputTime("Q_CASE_DATE_S", "Q_CASE_DATE_E");
      if ("" != "") {
        $("#Q_AID_DEPT_COUNTY").prop("disabled", true);
      }

      $("#Q_AID_DEPT_COUNTY").on("change", function () {
        if ($(this).val() != "") {
          EMS_ReloadSelect(
            "/Common/getAreaFireBureauDept" +
              "?AREA=" +
              $(this).val() +
              "&DEPT_NO=" +
              "",
            "Q_AID_DEPT_NO",
            "",
          );
        }
      });

      $("#Q_AID_DEPT_COUNTY").trigger("change");

      $("#Q_CASE_HOLDER").select2({
        language: "zh-TW",
        theme: "bootstrap",
        placeholder: "接報人",
        allowClear: true,
        width: "element",
        language: {
          noResults: function (params) {
            return "查無資料";
          },
        },
      });
    });
    $(window).resize(function () {
      $("#SearchDataGridList").datagrid("resize");
    });
    function SearchDataGridInit() {
      $("#SearchDataGridList").datagrid({
        //title: 'DataGrid',
        defaultSearchForm: "FormSearch",
        FirstSearchQuery: true,
        url: "/MED1100/JsonList",
        pagination: true,
        pageSize: 30,
        striped: true,
        onLoadSuccess: function (data) {
          var datagrid = this.id;

          if (
            data.Message != undefined &&
            data.Message != null &&
            data.Message != ""
          ) {
            $.messager.alert("報案紀錄維護", data.Message);
            return;
          }
          if (data == null || data.rows == null || data.rows.length == 0)
            $("#" + datagrid)
              .parents(".datagrid-wrap")
              .find(".EMSSearchNoData")
              .show();
          else if (data != null && data.rows != null && data.rows.length > 0)
            $("#" + datagrid)
              .parents(".datagrid-wrap")
              .find(".EMSSearchNoData")
              .hide();

          //預設勾選第一列
          var rows = $("#" + datagrid).datagrid("getRows");
          for (i = 0; i < rows.length; ++i) {
            if (i == 0) $("#" + datagrid).datagrid("checkRow", i);
          }
        },
        frozenColumns: [
          [
            {
              field: "checkbox",
              halign: "center",
              checkbox: true,
              align: "center",
              width: "50",
            },
          ],
        ],
        columns: [
          [
            {
              field: "FIREDEPT_CASENO",
              title: "指派案號",
              halign: "center",
              align: "center",
              width: "140",
              sortable: true,
            },
            {
              field: "EM_CASE_NO",
              title: "案號",
              halign: "center",
              align: "center",
              width: "140",
              sortable: true,
              formatter: action_CASENO,
            },
            {
              field: "CASE_DATE",
              title: "報案日期",
              halign: "center",
              align: "center",
              width: "100",
              sortable: true,
            },
            {
              field: "CASE_TIME",
              title: "受理時間",
              halign: "center",
              align: "center",
              width: "100",
              sortable: true,
            },
            {
              field: "MIN_AMBUTIME_1",
              title: "出勤通知時間",
              halign: "center",
              align: "center",
              width: "100",
              formatter: function (value, row, index) {
                return (
                  '<span title="來源：救護車派遣紀錄的第一個出勤通知時間" class="easyui-tooltip">' +
                  value +
                  "</span>"
                );
              },
            },
            {
              field: "CASE_REASON",
              title: "案由",
              halign: "center",
              align: "center",
              width: "120",
              formatter: action_REASON,
              sortable: true,
            },
            {
              field: "ACCIDENT_AREA",
              title: "發生行政區",
              halign: "center",
              align: "center",
              width: "120",
              sortable: true,
            },
            //{ field: 'COORDINATOR_DEPT', title: '聯絡單位', halign: 'center', align: 'center', width: '150', sortable: true },
            {
              field: "ACCIDENT_ADDR",
              title: "詳細發生地點",
              halign: "center",
              align: "left",
              width: "300",
              sortable: true,
            },
            { field: "CASE_NO_ENCODE", hidden: true },
            { field: "CASE_LOCK", hidden: true },
          ],
        ],
        onSelect: function (index, row) {
          if (row.CASE_LOCK == "Y") {
            $("#ViewBtns").find("#EditBtn").prop("disabled", true);
            $("#ViewBtns").find("#UnlockBtn").prop("disabled", false);
          } else {
            $("#ViewBtns").find("#EditBtn").prop("disabled", false);
            $("#ViewBtns").find("#UnlockBtn").prop("disabled", true);
          }
        },
      });
    }
    //填時間優化
    function newQtime(time, model) {
      var timeObj = document.getElementById(time).value;
      if (model == "time") {
        if (timeObj.length == 2) {
          document.getElementById(time).value = timeObj + ":";
        }
        if (timeObj.length == 5) {
          document.getElementById(time).value = timeObj + ":00";
        }
      }
      if (model == "date") {
        if (timeObj.length == 4) {
          document.getElementById(time).value = timeObj + "-";
        }
        if (timeObj.length == 7) {
          document.getElementById(time).value = timeObj + "-";
        }
      }
    }
    //檢查填時間優化
    function checknewQtime(time, model) {
      if (model == "time") {
        var patm = /^([0-1][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]$/;
      }
      if (model == "date") {
        var patm =
          /^(((?:19|20)[0-9]{2})[- /.](0?[1-9]|1[012])[- /.](0?[1-9]|[12][0-9]|3[01]))*$/;
      }
      if (
        !patm.exec(document.getElementById(time).value) &&
        document.getElementById(time).value != ""
      ) {
        document.getElementById(time).focus();
        document.getElementById(time).select();
        document.getElementById(time).value = "";
      }
    }
    function action_CASENO(index, row) {
      if (row.CASE_LOCK == "Y") return row.EM_CASE_NO + "(鎖定)";
      else return row.EM_CASE_NO;
    }
    function action_REASON(index, row) {
      if (row.CASE_REASON == null) return row.CASE_REASON_OTHER;
      if ($.trim(row.CASE_REASON_OTHER) != "")
        return row.CASE_REASON + "(" + row.CASE_REASON_OTHER + ")";
      else return row.CASE_REASON;
    }
    function AutoInputTime(date_source, date_target) {
      var form = $("#FormSearch");
      form.find("#" + date_source).on("change", function () {
        if (
          $(this).val() == "" ||
          $(this).val() < form.find("#" + date_target).val()
        ) {
          return;
        } else {
          form.find("#" + date_target).val($(this).val());
        }
      });
      form.find("#" + date_source).trigger("change");
    }
    function ClearForm(form_id) {
      $("#" + form_id)[0].reset();
      $("#" + form_id)
        .find("input[type=text]")
        .val("");
    }
    function OpenCreateDialog() {
      EMS_OpenDialog("CreateDialog", "/MED1100/Create");
    }
    function OpenEditDialog() {
      var SelectRow = EMS_getDataGridSelectRow("SearchDataGridList");

      if (
        SelectRow == null ||
        SelectRow == undefined ||
        $.trim(SelectRow.EM_CASE_NO) == ""
      ) {
        $.messager.alert("報案紀錄維護", "請選擇案件");
        return;
      }

      EMS_OpenDialog(
        "EditDialog",
        "/MED1100/Edit" + "?CASE_NO=" + SelectRow.EM_CASE_NO,
      );
    }
    function OpenDeleteDialog() {
      var SelectRow = EMS_getDataGridSelectRow("SearchDataGridList");

      if (
        SelectRow == null ||
        SelectRow == undefined ||
        $.trim(SelectRow.EM_CASE_NO) == ""
      ) {
        $.messager.alert("報案紀錄維護", "請選擇案件");
        return;
      }

      EMS_OpenDialog(
        "DeleteDialog",
        "/MED1100/Detail" + "?CASE_NO=" + SelectRow.EM_CASE_NO,
      );
    }
    function OpenDetailDialog() {
      var SelectRow = EMS_getDataGridSelectRow("SearchDataGridList");

      if (
        SelectRow == null ||
        SelectRow == undefined ||
        $.trim(SelectRow.EM_CASE_NO) == ""
      ) {
        $.messager.alert("報案紀錄維護", "請選擇案件");
        return;
      }

      EMS_OpenDialog(
        "DetailDialog",
        "/MED1100/Detail" + "?CASE_NO=" + SelectRow.EM_CASE_NO,
      );
    }
    function OpenAIDCase() {
      var SelectRow = EMS_getDataGridSelectRow("SearchDataGridList");
      var form = $("#FormSearch");
      if (
        SelectRow == null ||
        SelectRow == undefined ||
        $.trim(SelectRow.EM_CASE_NO) == "" ||
        $.trim(SelectRow.CASE_NO_ENCODE) == ""
      ) {
        $.messager.alert("報案紀錄維護", "請選擇案件");
        return;
      }
      parent.RemoveWebPage("MED2100");
      parent.WebPageToggle(
        "MED2100",
        "/MED2100?CASE_NO=" +
          SelectRow.CASE_NO_ENCODE +
          "&CASE_DATE_S=" +
          form.find("#Q_CASE_DATE_S").val() +
          "&CASE_DATE_E=" +
          form.find("#Q_CASE_DATE_E").val(),
      );
    }
    function BackAIDCase() {
      parent.WebPageToggle("MED2100", "/MED2100", "Y");
    }
    function CaseUnLock() {
      var SelectRow = EMS_getDataGridSelectRow("SearchDataGridList");

      if (
        SelectRow == null ||
        SelectRow == undefined ||
        $.trim(SelectRow.EM_CASE_NO) == ""
      ) {
        $.messager.alert("報案紀錄維護", "請選擇案件");
        return;
      }

      $.messager.confirm(
        "報案紀錄維護",
        "確定要將此筆案件解除鎖定?",
        function (r) {
          if (r) {
            var TransData = new Array(
              { name: "CASE_NO", value: SelectRow.EM_CASE_NO },
              {
                name: "__RequestVerificationToken",
                value: $(
                  '#FormSearch input[name="__RequestVerificationToken"]',
                ).val(),
              },
            );
            PageDataAjax(
              true,
              "/MED1100/EMCaseUnlock",
              TransData,
              CaseUnLockSuccess,
            );
          }
        },
      );
    }
    function CaseUnLockSuccess(response) {
      if (response.Success) {
        EMS_SearchDataGrid("SearchDataGridList");
        $.messager.alert("報案紀錄維護", "案件解鎖成功");
      } else {
        $.messager.alert("報案紀錄維護", response.Message);
      }
    }
    function OutputExcel() {
      PageFormAjax(
        true,
        "/MED1100/JsonListOutputExcel",
        "FormSearch",
        EMS_OutputFile_Success,
      );
    }
  </script>

  <div
    class="EMSDialog modal fade"
    id="Base_OutputFileDialog"
    tabindex="-1"
    role="dialog"
    aria-labelledby="資料匯出紀錄"
    data-keyboard="false"
    aria-hidden="true"
  >
    <div
      class="modal-dialog modal-dialog-centered DialogFull-Mobile"
      role="document"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">資料匯出紀錄</h5>
          <button
            type="button"
            class="close"
            onclick="EMS_CloseDialog(false, 'Base_OutputFileDialog')"
          >
            <span aria-hidden="true">×</span>
          </button>
        </div>
        <div class="modal-btns">
          <button
            type="button"
            class="btn btn-success"
            onclick="BaseOutputFile()"
          >
            送出
          </button>
          <button
            type="button"
            class="btn btn-danger"
            onclick="EMS_CloseDialog(false, 'Base_OutputFileDialog')"
          >
            關閉
          </button>
        </div>
        <div class="modal-body"></div>
      </div>
    </div>
  </div>

  <div
    id="ui-datepicker-div"
    class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"
  ></div>
  <div class="modal-backdrop fade in"></div>
</body>
